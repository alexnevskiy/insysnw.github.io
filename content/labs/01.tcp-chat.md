+++
title = "Домашнее Задание #1. TCP чат"
description = "Разрабатываем и реализуем свой протокол для чата"
template = "page.html"
[taxonomies]
categories = ["homework"]
+++

В рамках данной работы вы будете реализовывать консольный чат.
Для этого требуется разработать серверную и клиентскую части.

## Требования к чату:
* К одному серверу подключаются несколько клиентов.
* Отправляемое сообщение должно отобразиться у каждого подключенных в этот момент к данному серверу клиента (т.е. хранение и отображение истории реализовывать не требуется)
* Формат сообщения:
  `<HH:MM> [username] text of an actual message`
  Пример сообщения:
  `<4:20> [Kenobi] Hello there!`

## Требования к реализации:
* Самостоятельное использование TCP сокетов

## Требования к протоколу:
* Пользователь может отправлять сообщения только от своего имени
* Время в сообщение должно соответствовать реальному времени отправления сообщения
* Пользователи разных временных зон должны видеть корректное для себя время

## Требования к отчёту:
* Инструкция по использованию (конфигурационные файлы, переменные окружения, аргументы командной строки, данные передаваемые в *stdin*)
* Инструкции по сборке/установке
* Описание используемого протокола

Протокол должен быть описан так, чтобы не знакомой с вашей имплементацией разработчик мог написать свою на любом другом языке так, чтобы она оказалось совместима с вашей.
___

## Life pro tips

* Пользовательский интерфейс - дело не последнее, но он не является центром данной лабораторной работы
* Ваш протокол будет проверятся на способность справляться с различными данными (содержание и объём)
* Преподавательский состав данного курса позитивно относится к бережному отношению к ресурсам

___

## Типичные ошибки

Ваши коллеги уже наступали на эти грабли, учитесь на чужих ошибках.

### Использование строк вместо протокола

Основой данного задания является разработка протокола, а код - лишь проверка его работоспособности.
Существование протокола в отрыве от конкретной имлементации позволяет легко создать новую.
Например, с вашим сервером одновременно могут общаться совершенно разные клиенты: консольные, графические, вэб и боты, которым пользовательский интерфэйс чата совсем не нужен.
Каждый из этих клиентов может по своему отображать данные.
Так графические интерфейсы обычно не указывают имя автора у каждого из его подряд отправленных сообщений, а время отображают отдельно от текста сообщения.
Наличие протокола позволяет им легко этого добиться, ведь в нём все эти элементы "разложены по полочкам", а не спрятаны в рамках огромной строки.

Вторая проблема - подтверждение подлинности.
В строке можно указать любое имя пользователя и другие клиенты не смогут отличить реального пользователя от самозванца.
Время тоже никак не подтверждается.
Вам студенты будут рассказывать, что сдали свою работу до дедлайна, ссылаясь на сообщение с отчётом, в котором указана дата ещё до выдачи задания о.О
Ведь никто не мешает составить сообщение с любым временем, хоть `<half past nine>`

Ещё одна проблема на ровном месте - искусственное ограничение используемых символов в сообщение.
Теперь в имени пользователя не может быть как минимум символ и `]`, ведь с точки зрения клиента это специальный символ окончания имени пользователя.

### Одно сообщение - одно чтение буфера

Размер буфера - деталь имлементации, не протокола.
Велика вероятность того, что максимальный размер сообщения будет больше буфера, что ведёт к тому, что чтение из буфера один раз приведёт к неполному прочтению сообщения.
Протокол должен обеспечивать понимание того, прочитано ли сообщение целиком.

## Методика проверки

* Запуск
  * сервера как клиента на разных узлах в сети Интернет
  * минимум 2х клиентов на одном узле
* Отправление сообщения
  * от имени другого пользователя
  * со временеи на 3 часа раньше текущего
  * с текстом на 5 мегабайт


**TODO**: добавить описание типичных тестов, для проверки реализации *(например, минимальный объём для **большого** текста, атака на протокол)*
